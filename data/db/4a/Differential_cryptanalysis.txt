{{More footnotes|date=March 2009}}
'''Differential cryptanalysis''' is a general form of [[cryptanalysis]] applicable primarily to [[block cipher]]s, but also to [[stream cipher]]s and [[cryptographic hash function]]s. In the broadest sense, it is the study of how differences in information input can affect the resultant difference at the output. In the case of a block cipher, it refers to a set of techniques for tracing differences through the network of transformations, discovering where the [[cipher]] exhibits non-[[randomness|random]] behavior, and exploiting such properties to recover the secret [[key (cryptography)|key]].

==History==
The discovery of differential cryptanalysis is generally attributed to [[Eli Biham]] and [[Adi Shamir]] in the late 1980s, who published a number of attacks against various block ciphers and hash functions, including a theoretical weakness in the [[Data Encryption Standard]] (DES).  It was noted by Biham and Shamir that DES is surprisingly resistant to differential cryptanalysis but small modifications to the algorithm would make it much more susceptible.<ref>Biham and Shamir, 1993, pp. 8-9</ref>

In 1994, a member of the original IBM DES team, [[Don Coppersmith]], published a paper stating that differential cryptanalysis was known to IBM as early as 1974, and that defending against differential cryptanalysis had been a design goal.<ref name="coppersmith">
{{cite journal |doi = 10.1147/rd.383.0243 |last = Coppersmith |first = Don |date=May 1994 |title = The Data Encryption Standard (DES) and its strength against attacks |journal = IBM Journal of Research and Development |volume = 38 |issue = 3 |pages = 243 |url = http://www.research.ibm.com/journal/rd/383/coppersmith.pdf |format = PDF }} (subscription required)</ref>
According to author [[Steven Levy]], IBM had discovered differential cryptanalysis on its own, and the [[NSA]] was apparently well aware of the technique.<ref>{{cite book |last = Levy |first = Steven |authorlink = Steven Levy |title = Crypto: How the Code Rebels Beat the Government — Saving Privacy in the Digital Age |publisher = [[Penguin Books]] |year = 2001 |isbn = 0-14-024432-8 |pages = 55–56 }}</ref>
IBM kept some secrets, as Coppersmith explains: "After discussions with NSA, it was decided that disclosure of the design considerations would reveal the technique of differential cryptanalysis, a powerful technique that could be used against many ciphers. This in turn would weaken the competitive advantage the United States enjoyed over other countries in the field of cryptography."<ref name="coppersmith"/>
Within IBM, differential cryptanalysis was known as the "T-attack"<ref name="coppersmith"/> or "Tickle attack".<ref>Matt Blaze, [[sci.crypt]], 15 August 1996, [http://groups.google.com/group/sci.crypt/msg/5cd14a329372cc5a?dmode=source Re: Reverse engineering and the Clipper chip"]</ref><!-- not the solidest of cites -->

While DES was designed with resistance to differential cryptanalysis in mind, other contemporary ciphers proved to be vulnerable. An early target for the attack was the [[FEAL]] block cipher. The original proposed version with four rounds (FEAL-4) can be broken using only eight [[Chosen-plaintext attack|chosen plaintexts]], and even a 31-round version of FEAL is susceptible to the attack. In contrast, the scheme can successfully cryptanalyze DES with an effort on the order 2<sup>47</sup> chosen plaintexts.

==Attack mechanics==
Differential cryptanalysis is usually a [[chosen plaintext attack]], meaning that the attacker must be able to obtain [[Encryption|ciphertexts]] for some set of [[plaintext]]s of his choosing. There are, however, extensions that would allow a [[known plaintext attack|known plaintext]] or even a [[ciphertext-only attack]]. The basic method uses pairs of plaintext related by a constant ''difference''; [[Subtraction|difference]] can be defined in several ways, but the [[Exclusive or|eXclusive OR (XOR)]] operation is usual. The attacker then computes the differences of the corresponding ciphertexts, hoping to detect statistical patterns in their distribution. The resulting pair of differences is called a '''differential'''. Their statistical properties depend upon the nature of the [[S-box]]es used for encryption, so the attacker analyses differentials (Δ<sub>''X''</sub>, Δ<sub>''Y''</sub>), where Δ<sub>''Y''</sub> = ''S''(''X'' ⊕ Δ<sub>''X''</sub>) ⊕ ''S''(''X'') (and ⊕ denotes exclusive or) for each such S-box ''S''. In the basic attack, one particular ciphertext difference is expected to be especially frequent; in this way, the [[cipher]] can be distinguished from [[randomness|random]]. More sophisticated variations allow the key to be recovered faster than [[Brute force attack|exhaustive search]].

In the most basic form of key recovery through differential cryptanalysis, an attacker requests the ciphertexts for a large number of plaintext pairs, then assumes that the differential holds for at least ''r'' − 1 rounds, where ''r'' is the total number of rounds. The attacker then deduces which round keys (for the final round) are possible, assuming the difference between the blocks before the final round is fixed. When round keys are short, this can be achieved by simply exhaustively decrypting the ciphertext pairs one round with each possible round key. When one round key has been deemed a potential round key considerably more often than any other key, it is assumed to be the correct round key.

For any particular cipher, the input difference must be carefully selected for the attack to be successful. An analysis of the algorithm's internals is undertaken; the standard method is to trace a path of highly probable differences through the various stages of encryption, termed a ''differential characteristic''.

Since differential cryptanalysis became public knowledge, it has become a basic concern of cipher designers. New designs are expected to be accompanied by evidence that the algorithm is resistant to this attack, and many, including the [[Advanced Encryption Standard]], have been [[Mathematical proof|proven]] secure against the attack{{Citation needed|date=September 2015}}.

==Attack in detail==
The attack relies primarily on the fact that a given input/output difference pattern only occurs for certain values of inputs.  Usually the attack is applied in essence to the non-linear components as if they were a solid component (usually they are in fact look-up tables or ''sboxes'').  Observing the desired output difference (between two chosen or known plaintext inputs) ''suggests'' possible key values.

For example, if a differential of 1 => 1 (implying a difference in the [[least significant bit]] (LSB) of the input leads to an output difference in the LSB) occurs with probability of 4/256 (possible with the non-linear function in the [[AES cipher]] for instance) then for only 4 values (or 2 pairs) of inputs is that differential possible.  Suppose we have a non-linear function where the key is XOR'ed before evaluation and the values that allow the differential are {2,3} and {4,5}.  If the attacker sends in the values of {6, 7} and observes the correct output difference it means the key is either 6 xor K = 2 or 6 xor K = 4, meaning the key is either K = {2,4}.

In essence, for an n-bit non-linear function one would ideally seek as close to 2<sup>-(n-1)</sup> as possible to achieve ''differential uniformity''.  When this happens, the differential attack requires as much work to determine the key as simply brute forcing the key.

The AES non-linear function has a maximum differential probability of 4/256 (most entries however are either 0 or 2).  Meaning that in theory one could determine the key with half as much work as brute force, however, the high branch of AES prevents any high probability trails from existing over multiple rounds.  In fact, the AES cipher would be just as immune to differential and linear attacks with a much ''weaker'' non-linear function.  The incredibly high branch (active sbox count) of 25 over 4R means that over 8 rounds no attack involves fewer than 50 non-linear transforms, meaning that the probability of success does not exceed Pr[attack] ≤ Pr[best attack on sbox]<sup>50</sup>.  For example, with the current sbox AES emits no fixed differential with a probability higher than (4/256)<sup>50</sup> or 2<sup>−300</sup> which is far lower than the required threshold of 2<sup>−128</sup> for a 128-bit block cipher.  This would have allowed room for a more efficient sbox, even if it is 16-uniform the probability of attack would have still been 2<sup>−200</sup>.

There exist no bijections for even sized inputs/outputs with 2-uniformity.  They exist in odd fields (such as GF(2<sup>7</sup>)) using either cubing or inversion (there are other exponents that can be used as well).  For instance S(x) = x<sup>3</sup> in any odd binary field is immune to differential and linear cryptanalysis.  This is in part why the [[MISTY]] designs use 7- and 9-bit functions in the 16-bit non-linear function.  What these functions gain in immunity to differential and linear attacks they lose to algebraic attacks.  That is, they are possible to describe and solve via a SAT solver.  This is in part why AES (for instance) has an affine mapping after the inversion.

==Specialized types==
* [[Higher-order differential cryptanalysis]]
* [[Truncated differential cryptanalysis]]
* [[Impossible differential cryptanalysis]]
* [[Boomerang attack]]

==See also==
* [[Cryptography]]
* [[Linear cryptanalysis]]

==References==
{{Reflist|30em}}

;General
{{Refbegin}}
* Eli Biham, Adi Shamir, Differential Cryptanalysis of the Data Encryption Standard, Springer Verlag, 1993. ISBN 0-387-97930-1, ISBN 3-540-97930-1.
* Biham, E. and A. Shamir. (1990). Differential Cryptanalysis of DES-like Cryptosystems. Advances in Cryptology &mdash; CRYPTO '90. Springer-Verlag. 2&ndash;21.
* Eli Biham, Adi Shamir,"Differential Cryptanalysis of the Full 16-Round DES," CS 708, Proceedings of CRYPTO '92, Volume 740 of Lecture Notes in Computer Science, December 1991. [http://www.cs.technion.ac.il/users/wwwb/cgi-bin/tr-get.cgi/1991/CS/CS0708.ps (Postscript)]

==External links==
* [http://www.engr.mun.ca/~howard/Research/Papers/ldc_tutorial.html A tutorial on differential (and linear) cryptanalysis]
* [http://research.cyber.ee/~lipmaa/crypto/link/block/dc.php Helger Lipmaa's links on differential cryptanalysis]
* {{Wayback |date=20071019130512 |url=http://home.earthlink.net/~mylnir/desdoc.html |title=A description of the attack applied to DES }}

{{Cryptography navbox |block}}

[[Category:Cryptographic attacks]]