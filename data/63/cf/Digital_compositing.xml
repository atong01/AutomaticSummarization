<article title='Digital_compositing'><paragraph><template><target>multiple issues</target><arg name="{{Technical|date">April 2012}}
{{no footnotes|date</arg></template><link><target>File:Altmer High Elves trapped and outnumbered but we won't die today.jpg</target><part>thumb</part><part>Four images assembled into one final image</part></link><bold>Digital compositing</bold><space/>is the process of digitally assembling multiple images to make a final image, typically for print,<space/><link><target>film</target><part>motion pictures</part></link><space/>or screen display. It is the evolution into the digital realm of optical film<space/><link><target>compositing</target></link>.</paragraph><heading level='2'>Mathematics</heading><paragraph>The basic operation used in digital compositing is known as '<link><target>alpha compositing#Alpha blending</target><part>alpha blending</part></link>', where an opacity value, '', is used to control the proportions of two input<space/><link><target>pixel</target></link><space/>values that end up a single output pixel.</paragraph><paragraph>As a simple example, suppose two images of the same size are available and they are to be composited. The input images are referred to as the foreground image and the background image. Each image consists of the same number of<space/><link><target>pixel</target><trail>s</trail></link>. Compositing is performed by mathematically combining information from the corresponding pixels from the two input images and recording the result in a third image, which is called the composited image.</paragraph><paragraph>Consider three pixels;</paragraph><list type='bullet'><listitem>a foreground pixel, f</listitem><listitem>a background pixel, b</listitem><listitem>a composited pixel, c</listitem></list><paragraph>and<space/></paragraph><list type='bullet'><listitem>, the opacity value of the foreground pixel. ( = 1 for opaque foreground, = 0 for a completely transparent foreground). A monochrome raster image where the pixel values are to be interpreted as alpha values is known as a<space/><link><target>matte (filmmaking)</target><part>matte</part></link>.</listitem></list><paragraph>Then, considering all three colour channels, and assuming that the colour channels are expressed in a =1 colour space (that is to say, the measured values are proportional to light intensity), we have:</paragraph><list type='ident'><listitem>c<xhtml:sub>r</xhtml:sub><space/>= f<xhtml:sub>r</xhtml:sub><space/>+ (1 ) b<xhtml:sub>r</xhtml:sub></listitem><listitem>c<xhtml:sub>g</xhtml:sub><space/>= f<xhtml:sub>g</xhtml:sub><space/>+ (1 ) b<xhtml:sub>g</xhtml:sub></listitem><listitem>c<xhtml:sub>b</xhtml:sub><space/>= f<xhtml:sub>b</xhtml:sub><space/>+ (1 ) b<xhtml:sub>b</xhtml:sub></listitem></list><paragraph>Note that if the operations are performed in a colour space where is not equal to 1 then the operation will lead to non-linear effects which can potentially be seen as<space/><link><target>aliasing</target></link><space/>artifacts (or '<link><target>jaggies</target></link>') along sharp edges in the matte. More generally, nonlinear compositing can have effects such as &quot;halos&quot; around composited objects, because the influence of the alpha channel is non-linear. It is possible for a compositing artist to compensate for the effects of compositing in non-linear space.</paragraph><paragraph>Performing alpha blending is an expensive operation if performed on an entire image or 3D scene. If this operation has to be done in real time video games there is an easy trick to boost performance.</paragraph><list type='ident'><listitem>c<xhtml:sub>out</xhtml:sub><space/>= f<xhtml:sub>in</xhtml:sub><space/>+ (1 ) b<xhtml:sub>in</xhtml:sub></listitem><listitem>c<xhtml:sub>out</xhtml:sub><space/>= f<xhtml:sub>in</xhtml:sub><space/>+ b<xhtml:sub>in</xhtml:sub><space/>b<xhtml:sub>in</xhtml:sub></listitem><listitem>c<xhtml:sub>out</xhtml:sub><space/>= b<xhtml:sub>in</xhtml:sub><space/>+ (f<xhtml:sub>in</xhtml:sub><space/>b<xhtml:sub>in</xhtml:sub>)</listitem></list><paragraph>By simply rewriting the mathematical expression one can save 50% of the multiplications required.</paragraph><heading level='3'>Algebraic properties</heading><paragraph>When many partially transparent layers need to be composited together, it is worthwhile to consider the algebraic properties of compositing operators used. Specifically, the associativity and commutativity determine when repeated calculation can or cannot be avoided.</paragraph><paragraph>Consider the case when we have four layers to blend to produce the final image: F=A*(B*(C*D)) where A, B, C, D are partially transparent image layers and &quot;*&quot; denotes a compositing operator (with the left layer on top of the right layer). If only layer C changes, we should find a way to avoid re-blending all of the layers when computing F. Without any special considerations, four full-image blends would need to occur. For compositing operators that are<space/><link><target>commutative</target></link>, such as additive blending, it is safe to re-order the blending operations. In this case, we might compute T=A*(B*D) only once and simply blend T*C to produce F, a single operation. Unfortunately, most operators are not commutative. However, many are<space/><link><target>associative</target></link>, suggesting it is safe to re-group operations to F=(A*B)*(C*D), i.e. without changing their order. In this case we may compute S:=A*B once and save this result. To form F with an associative operator, we need only do two additional compositing operations to integrate the new layer S, by computing F:=S*(C*D). Note that this expression indicates compositing C with all of the layers below it in one step and then blending all of the layers on top of it with the previous result to produce the final image in the second step.</paragraph><paragraph>If all layers of an image change regularly but a large number of layer still need to be composited (such as in distributed rendering), the commutativity of a compositing operator can still be exploited to speed up computation through<space/><link><target>parallelism (computing)</target><part>parallelism</part></link><space/>even when there is no gain from pre-computation. Again, consider the image F=A*(B*(C*D)). Each compositing operation in this expression depends on the next, leading to serial computation. However, associativity can allow us to rewrite F=(A*B)*(C*D) where there are clearly two operations that do not depend on each other that may be executed in parallel. In general, we can build a tree of pair-wise compositing operations with a height that is logarithmic in the number of layers.</paragraph><heading level='2'>Software</heading><paragraph>The most historically significant nonlinear compositing system was the<space/><link><target>Cineon</target></link>, which operated in a logarithmic color space, which more closely mimics the natural light response of film emulsions (the Cineon system, made by Kodak, is no longer in production). Due to the limitations of processing speed and memory, compositing artists did not usually have the luxury of having the system make intermediate conversions to linear space for the compositing steps. Over time, the limitations have become much less significant, and now most compositing is done in a linear color space, even in cases where the source imagery is in a logarithmic color space.</paragraph><paragraph>Compositing often also includes scaling, retouching and colour correction of images.</paragraph><heading level='3'>Node-based and layer-based compositing</heading><paragraph>There are two radically different digital compositing workflows: node-based compositing and layer-based compositing.</paragraph><paragraph>Node-based compositing represents an entire composite as a tree graph, linking media objects and effects in a procedural map, intuitively laying out the progression from source input to final output, and is in fact the way all compositing applications internally handle composites. This type of compositing interface allows great flexibility, including the ability to modify the parameters of an earlier image processing step &quot;in context&quot; (while viewing the final<space/><link><target>compositing</target><part>composite</part></link>). Node-based compositing packages often handle keyframing and time effects poorly, as their workflow does not stem directly from a timeline, as do layer-based compositing packages. Software which incorporates a node based interface include<space/><link><target>Apple Shake</target></link>,<space/><link><target>Blender (software)</target><part>Blender</part></link>,<space/><link><target>eyeon Fusion</target></link>, and<space/><link><target>nuke (software)</target><part>The Foundry's Nuke</part></link>.</paragraph><paragraph>Layer-based compositing represents each media object in a composite as a separate layer within a timeline, each with its own time bounds, effects, and keyframes. All the layers are stacked, one above the next, in any desired order; and the bottom layer is usually<space/><link><target>rendering (computer graphics)</target><part>rendered</part></link><space/>as a base in the resultant image, with each higher layer being progressively rendered on top of the previously composited of layers, moving upward until all layers have been rendered into the final composite. Layer-based compositing is very well suited for rapid<space/><link><target>2D computer graphics</target><part>2D</part></link><space/>and limited<space/><link><target>3D computer graphics</target><part>3D</part></link><space/>effects such as in motion graphics, but becomes awkward for more complex composites entailing a large number of layers. A partial solution to this is some programs' ability to view the composite-order of elements (such as images, effects, or other attributes) with a visual diagram called a<space/><link><target>Flowchart (Adobe)</target><part>flowchart</part></link><space/>to nest compositions, or &quot;comps,&quot; directly into other compositions, thereby adding complexity to the render-order by first compositing layers in the beginning composition, then combining that resultant image with the layered images from the proceeding composition, and so on. An example of this exists in the Adobe program<space/><link><target>After Effects</target></link>.</paragraph><heading level='2'>See also</heading><list type='bullet'><listitem><link><target>Broadcast designer</target></link></listitem><listitem><link><target>Chroma key</target></link></listitem><listitem><link><target>Digital asset</target></link></listitem><listitem><link><target>Digital cinema</target></link></listitem><listitem><link><target>Digital on-screen graphic</target></link><space/>(BUG)</listitem><listitem><link><target>Gamma correction</target></link></listitem><listitem><link><target>Graphics coordinator</target></link></listitem><listitem><link><target>Motion graphic</target></link></listitem><listitem><link><target>Motion graphic design</target></link></listitem></list><heading level='2'>Further reading</heading><list type='bullet'><listitem><template><target>cite conference</target><arg name="author"><space/>Mansi Sharma; Santanu Chaudhury; Brejesh Lall;
</arg><arg name="conference">Proceedings of the 2014 Indian Conference on Computer Vision Graphics and Image Processing, ACM New York, NY, USA 
</arg><arg name="title">Content-aware seamless stereoscopic 3D compositing
</arg><arg name="date">2014
</arg><arg name="doi">10.1145/2683483.2683555
</arg><arg name="url">http://dl.acm.org/citation.cfm?id</arg></template></listitem><listitem>T. Porter and T. Duff, &quot;Compositing Digital Images&quot;, Proceedings of SIGGRAPH '84, 18 (1984).</listitem><listitem>The Art and Science of Digital Compositing (ISBN 0-12-133960-2)</listitem></list><paragraph><template><target>Compositing Software</target></template></paragraph><paragraph><link><target>Category:Special effects</target></link><link><target>Category:Film and video technology</target></link><link><target>Category:Compositing software</target><part></part></link><link><target>Category:Film and video terminology</target></link></paragraph></article>